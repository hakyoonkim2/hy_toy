import{r as f,u as D,j as e,l as g,L}from"./index-CweFeKZ8.js";import{u as d,a as k,s as a,f as F,C}from"./CoinChartView-DQMGhPEF.js";import{u as b,q as S}from"./SymbolContextProvider-BCCwxcsB.js";const v=n=>{const u=n.replace("USDT","");return d({queryKey:["symbol",`KRW-${u}`],queryFn:async()=>null,initialData:null,staleTime:1/0})},N=({symbol:n})=>{const{setSymbol:u}=b(),{data:t}=k(n),{data:c}=v(n),l=f.useRef(null),y=D(),{data:r}=d({queryKey:["exchange-rate","USD-KRW"],queryFn:F,staleTime:1e3*60*10,gcTime:1e3*60*60,refetchOnWindowFocus:!1}),p=()=>{u(n),g.isMobile&&y("/chart/chartview")},i=(t==null?void 0:t.price)??0,s=(t==null?void 0:t.openPrice)??1,m=i===0?0:((i-s)/s*100).toFixed(2),o=(t==null?void 0:t.color)??"#FFFFFF",j=!!(c&&r&&i&&c.price/r-i>0);return f.useEffect(()=>{let h=null;if(l.current){const x=l.current;x.classList.add(a.pricehighlight),h=setTimeout(()=>{x.classList.remove(a.pricehighlight)},300)}return()=>{h&&(clearTimeout(h),h=null)}},[t]),e.jsxs("div",{className:a.chartList,onClick:p,children:[e.jsx("div",{children:e.jsx("strong",{className:a.symbolListLabel,children:n.replace("USDT","")})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",textAlign:"right"},children:[e.jsxs("div",{children:[e.jsx("strong",{ref:l,className:a.price,style:{color:o},children:`${i}`}),e.jsx("strong",{className:a.price,style:{color:o,marginLeft:"10px"},children:`${m}% `}),e.jsx("strong",{className:a.price,style:{marginLeft:"10px"},children:"USD"})]}),i&&c&&r?e.jsxs("div",{className:a.krwPrice,children:[e.jsx("strong",{children:"김프: "}),e.jsx("strong",{style:{color:j?"#f75467":"#4386f9"},children:`${((c.price/r-i)/i*100).toFixed(2)}% `}),e.jsx("strong",{style:{marginLeft:"10px"},children:"KRW: "}),e.jsx("strong",{style:{color:o},children:`${c.price.toLocaleString()}`})]}):e.jsx(e.Fragment,{})]})]})},U=()=>{const{symbolList:n,setSymbolList:u,worker:t,upbitWorker:c}=b(),l=S(),y=f.useRef(!1);return f.useEffect(()=>{const r=i=>{const s=i.data;(s==null?void 0:s.type)==="symbolData"&&(Object.entries(s.data).forEach(([m,o])=>{l.setQueryData(["symbol",m],o)}),y.current===!1&&Object.keys(s.data).length>0&&(u(Object.keys(s.data)),y.current=!0))},p=i=>{const s=i.data;(s==null?void 0:s.type)==="UpbitsymbolData"?l.setQueryData(["symbol",s.data.symbol],s.data):(s==null?void 0:s.type)==="UpbitRestsymbolData"&&Object.entries(s.data).forEach(([m,o])=>{l.setQueryData(["symbol",m],o)})};c instanceof SharedWorker?c.port.onmessage=p:c.onmessage=p,t instanceof SharedWorker?t.port.onmessage=r:t.onmessage=r},[]),e.jsxs("div",{className:a.app,children:[e.jsx("div",{className:a.listContainer,style:{minWidth:g.isMobile?"100%":"300px"},children:n.length>0?n.map(r=>e.jsx(N,{symbol:r},r)):e.jsx(L,{})}),g.isMobile?e.jsx(e.Fragment,{}):e.jsx(C,{})]})};export{U as default};
