import{r as p,u as L,j as e,l as y,L as k}from"./index-D8Pja7K9.js";import{u as x,a as F,s as r,f as C,C as D}from"./CoinChartView-RTNwgqQm.js";import{u as b,q as S}from"./SymbolContextProvider-CnV03yjC.js";const N=o=>{const c=o.replace("USDT","");return x({queryKey:["symbol",`KRW-${c}`],queryFn:async()=>null,initialData:null,staleTime:1/0})},v=({symbol:o})=>{const{setSymbol:c}=b(),{data:i}=F(o),{data:n}=N(o),l=p.useRef(null),u=L(),{data:a}=x({queryKey:["exchange-rate","USD-KRW"],queryFn:C,staleTime:1e3*60*10,gcTime:1e3*60*60,refetchOnWindowFocus:!1}),d=()=>{c(o),y.isMobile&&u("/chart/chartview")},s=(i==null?void 0:i.price)??0,t=(i==null?void 0:i.openPrice)??1,g=s===0?0:((s-t)/t*100).toFixed(2),m=(i==null?void 0:i.color)??"#FFFFFF",j=!!(n&&a&&s&&n.price/a-s>0);return p.useEffect(()=>{let h=null;if(l.current){const f=l.current;f.classList.add(r.pricehighlight),h=setTimeout(()=>{f.classList.remove(r.pricehighlight)},300)}return()=>{h&&(clearTimeout(h),h=null)}},[i]),e.jsxs("div",{className:r.chartList,onClick:d,children:[e.jsx("div",{children:e.jsx("strong",{className:r.symbolListLabel,children:o.replace("USDT","")})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",textAlign:"right"},children:[e.jsxs("div",{children:[e.jsx("strong",{ref:l,className:r.price,style:{color:m},children:`${s}`}),e.jsx("strong",{className:r.price,style:{color:m,marginLeft:"10px"},children:`${g}% `}),e.jsx("strong",{className:r.price,style:{marginLeft:"10px"},children:"USD"})]}),s&&n&&a?e.jsxs("div",{className:r.krwPrice,children:[e.jsx("strong",{children:"김프: "}),e.jsx("strong",{style:{color:j?"#f75467":"#4386f9"},children:`${((n.price/a-s)/s*100).toFixed(2)}% `}),e.jsx("strong",{style:{marginLeft:"10px"},children:"KRW: "}),e.jsx("strong",{style:{color:m},children:`${n.price.toLocaleString()}`})]}):e.jsx(e.Fragment,{})]})]})},E=()=>{const{symbolList:o,setSymbolList:c,worker:i,upbitWorker:n}=b(),l=S(),u=p.useRef(!1);return p.useEffect(()=>{const a=s=>{const t=s.data;(t==null?void 0:t.type)==="symbolData"?(Object.entries(t.data).forEach(([g,m])=>{l.setQueryData(["symbol",g],m)}),u.current===!1&&Object.keys(t.data).length>0&&(c(Object.keys(t.data)),u.current=!0)):console.log(s.data)},d=s=>{const t=s.data;(t==null?void 0:t.type)==="UpbitsymbolData"&&(console.log(s.data),l.setQueryData(["symbol",t.data.symbol],t.data)),console.log(s.data)};n instanceof SharedWorker?n.port.onmessage=d:n.onmessage=d,i instanceof SharedWorker?i.port.onmessage=a:i.onmessage=a},[]),e.jsxs("div",{className:r.app,children:[e.jsx("div",{className:r.listContainer,style:{minWidth:y.isMobile?"100%":"300px"},children:o.length>0?o.map(a=>e.jsx(v,{symbol:a},a)):e.jsx(k,{})}),y.isMobile?e.jsx(e.Fragment,{}):e.jsx(D,{})]})};export{E as default};
