import{r as f,u as L,j as e,l as g,L as F}from"./index-Cuqyt3tt.js";import{u as b,a as k,s as a,C as v}from"./CoinChartView-D8g457bV.js";import{u as j,q as C,t as S,v as d}from"./SymbolContextProvider-9K92mtPr.js";const N=n=>{const u=n.replace("USDT","");return b({queryKey:["symbol",`KRW-${u}`],queryFn:async()=>null,initialData:null,staleTime:1/0})},R=({symbol:n})=>{const{setSymbol:u}=j(),{data:t}=k(n),{data:l}=N(n),c=f.useRef(null),y=L(),{data:r}=b({queryKey:["exchange-rate","USD-KRW"],queryFn:C,staleTime:1e3*60*10,gcTime:1e3*60*60,refetchOnWindowFocus:!1}),p=()=>{u(n),g.isMobile&&y("/chart/chartview")},i=(t==null?void 0:t.price)??0,s=(t==null?void 0:t.openPrice)??1,m=i===0?0:((i-s)/s*100).toFixed(2),o=(t==null?void 0:t.color)??"#FFFFFF",D=!!(l&&r&&i&&l.price/r-i>0);return f.useEffect(()=>{let h=null;if(c.current){const x=c.current;x.classList.add(a.pricehighlight),h=setTimeout(()=>{x.classList.remove(a.pricehighlight)},300)}return()=>{h&&(clearTimeout(h),h=null)}},[t]),e.jsxs("div",{className:a.chartList,onClick:p,children:[e.jsx("div",{children:e.jsx("strong",{className:a.symbolListLabel,children:n.replace("USDT","")})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",textAlign:"right"},children:[e.jsxs("div",{children:[e.jsx("strong",{ref:c,className:a.price,style:{color:o},children:`${i}`}),e.jsx("strong",{className:a.price,style:{color:o,marginLeft:"10px"},children:`${m}% `}),e.jsx("strong",{className:a.price,style:{marginLeft:"10px"},children:"USD"})]}),i&&l&&r?e.jsxs("div",{className:a.krwPrice,children:[e.jsx("strong",{children:"김프: "}),e.jsx("strong",{style:{color:D?"#f75467":"#4386f9"},children:`${((l.price/r-i)/i*100).toFixed(2)}% `}),e.jsx("strong",{style:{marginLeft:"10px"},children:"KRW: "}),e.jsx("strong",{style:{color:o},children:`${l.price.toLocaleString()}`})]}):e.jsx(e.Fragment,{})]})]})},T=()=>{const{symbolList:n,setSymbolList:u,worker:t,upbitWorker:l}=j(),c=S(),y=f.useRef(!1);return f.useEffect(()=>{const r=i=>{const s=i.data;(s==null?void 0:s.type)==="symbolData"&&(Object.entries(s.data).forEach(([m,o])=>{c.setQueryData(["symbol",m],o)}),y.current===!1&&Object.keys(s.data).length>0&&(u(Object.keys(s.data)),y.current=!0))},p=i=>{const s=i.data;(s==null?void 0:s.type)==="UpbitsymbolData"?c.setQueryData(["symbol",s.data.symbol],s.data):(s==null?void 0:s.type)==="UpbitRestsymbolData"&&Object.entries(s.data).forEach(([m,o])=>{c.setQueryData(["symbol",m],o)})};d(t)?t.port.onmessage=r:t.onmessage=r,d(l)?l.port.onmessage=p:l.onmessage=p},[]),e.jsxs("div",{className:a.app,children:[e.jsx("div",{className:a.listContainer,style:{minWidth:g.isMobile?"100%":"300px"},children:n.length>0?n.map(r=>e.jsx(R,{symbol:r},r)):e.jsx(F,{})}),g.isMobile?e.jsx(e.Fragment,{}):e.jsx(v,{})]})};export{T as default};
