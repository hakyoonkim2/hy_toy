import{r as f,u as L,j as e,l as d,L as k}from"./index-DRVkii87.js";import{u as x,a as F,s as a,f as C,C as D}from"./CoinChartView-CuV-i3rm.js";import{u as b,q as S}from"./SymbolContextProvider-BEx7MYt7.js";const v=n=>{const o=n.replace("USDT","");return x({queryKey:["symbol",`KRW-${o}`],queryFn:async()=>null,initialData:null,staleTime:1/0})},N=({symbol:n})=>{const{setSymbol:o}=b(),{data:t}=F(n),{data:c}=v(n),l=f.useRef(null),u=L(),{data:r}=x({queryKey:["exchange-rate","USD-KRW"],queryFn:C,staleTime:1e3*60*10,gcTime:1e3*60*60,refetchOnWindowFocus:!1}),h=()=>{o(n),d.isMobile&&u("/chart/chartview")},i=(t==null?void 0:t.price)??0,s=(t==null?void 0:t.openPrice)??1,p=i===0?0:((i-s)/s*100).toFixed(2),m=(t==null?void 0:t.color)??"#FFFFFF",j=!!(c&&r&&i&&c.price/r-i>0);return f.useEffect(()=>{let y=null;if(l.current){const g=l.current;g.classList.add(a.pricehighlight),y=setTimeout(()=>{g.classList.remove(a.pricehighlight)},300)}return()=>{y&&(clearTimeout(y),y=null)}},[t]),e.jsxs("div",{className:a.chartList,onClick:h,children:[e.jsx("div",{children:e.jsx("strong",{className:a.symbolListLabel,children:n.replace("USDT","")})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",textAlign:"right"},children:[e.jsxs("div",{children:[e.jsx("strong",{ref:l,className:a.price,style:{color:m},children:`${i}`}),e.jsx("strong",{className:a.price,style:{color:m,marginLeft:"10px"},children:`${p}% `}),e.jsx("strong",{className:a.price,style:{marginLeft:"10px"},children:"USD"})]}),i&&c&&r?e.jsxs("div",{className:a.krwPrice,children:[e.jsx("strong",{children:"김프: "}),e.jsx("strong",{style:{color:j?"#f75467":"#4386f9"},children:`${((c.price/r-i)/i*100).toFixed(2)}% `}),e.jsx("strong",{style:{marginLeft:"10px"},children:"KRW: "}),e.jsx("strong",{style:{color:m},children:`${c.price.toLocaleString()}`})]}):e.jsx(e.Fragment,{})]})]})},E=()=>{const{symbolList:n,setSymbolList:o,worker:t,upbitWorker:c}=b(),l=S(),u=f.useRef(!1);return f.useEffect(()=>{const r=i=>{const s=i.data;(s==null?void 0:s.type)==="symbolData"&&(Object.entries(s.data).forEach(([p,m])=>{l.setQueryData(["symbol",p],m)}),u.current===!1&&Object.keys(s.data).length>0&&(o(Object.keys(s.data)),u.current=!0))},h=i=>{const s=i.data;(s==null?void 0:s.type)==="UpbitsymbolData"&&l.setQueryData(["symbol",s.data.symbol],s.data)};c instanceof SharedWorker?c.port.onmessage=h:c.onmessage=h,t instanceof SharedWorker?t.port.onmessage=r:t.onmessage=r},[]),e.jsxs("div",{className:a.app,children:[e.jsx("div",{className:a.listContainer,style:{minWidth:d.isMobile?"100%":"300px"},children:n.length>0?n.map(r=>e.jsx(N,{symbol:r},r)):e.jsx(k,{})}),d.isMobile?e.jsx(e.Fragment,{}):e.jsx(D,{})]})};export{E as default};
